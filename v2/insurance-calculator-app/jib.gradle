jib {
    from {
        image = 'eclipse-temurin:21-jre-alpine'
        platforms {
            platform {
                architecture = 'amd64'
                os = 'linux'
            }
        }
    }
    to {
        image = "insurance-calculator"
        tags = [project.version, 'latest']
    }
    extraDirectories {
        paths = [file('build/libs')]
        permissions = ['insurance-calculator-${project.version}.jar': '755']
    }
    container {
        appRoot = '/app'
        ports = ['8080']
        creationTime = 'USE_CURRENT_TIMESTAMP'

        jvmFlags = [
                '-Xms256m',
                '-Xmx512m',
                '-XX:MaxRAMPercentage=75.0',
                '-Djava.security.egd=file:/dev/./urandom'
        ]
        entrypoint = [
                'java', '-jar', "insurance-calculator-${project.version}.jar"
        ]
        labels = [
                'maintainer': 'Fistedar-PC',
                'version': project.version as String
        ]
    }
}